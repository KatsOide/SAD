leapsecs(3)                Library Functions Manual                leapsecs(3)



NNAAMMEE
       leapsecs - handle UTC leap seconds

SSYYNNTTAAXX
       ##iinncclluuddee <<lleeaappsseeccss..hh>>

       int lleeaappsseeccss__ssuubb(&_t);
       void lleeaappsseeccss__aadddd(&_t,_h_i_t);

       int lleeaappsseeccss__rreeaadd();
       int lleeaappsseeccss__iinniitt();

       struct tai _t;
       int _h_i_t;

DDEESSCCRRIIPPTTIIOONN
       lleeaappsseeccss__ssuubb  changes  a seconds-since-epoch count into a non-leap-sec‐
       onds-since-epoch count.  It interprets _t as a  TAI64  label,  subtracts
       from  _t  the  number of leap seconds that have occurred before or at _t,
       and places the result back into _t.

       lleeaappsseeccss__ssuubb returns 1 if _t was a leap second, 0 otherwise.

       lleeaappsseeccss__aadddd reverses the effect of lleeaappsseeccss__ssuubb.  _h_i_t must be 1 for  a
       leap second, 0 otherwise.

LLEEAAPP--SSEECCOONNDD TTAABBLLEE
       The  current  implementation  of  lleeaappsseeccss__ssuubb  and lleeaappsseeccss__aadddd uses a
       leap-second table read from disk.

       lleeaappsseeccss__rreeaadd reads  the  leap-second  table  from  //lleeaappsseeccss..ddaatt.   It
       returns  0  on  success, -1 on error.  If //lleeaappsseeccss..ddaatt does not exist,
       lleeaappsseeccss__rreeaadd treats it as an empty file.

       lleeaappsseeccss__iinniitt is a one-time version of lleeaappsseeccss__rreeaadd.  Initially it  is
       the  same  as  lleeaappsseeccss__rreeaadd;  however,  once  lleeaappsseeccss__rreeaadd returns 0,
       lleeaappsseeccss__iinniitt will always return 0 without calling lleeaappsseeccss__rreeaadd again.

       lleeaappsseeccss__aadddd  and  lleeaappsseeccss__ssuubb  call   lleeaappsseeccss__iinniitt.    WWAARRNNIINNGG::   If
       lleeaappsseeccss__iinniitt  returns failure, lleeaappsseeccss__aadddd and lleeaappsseeccss__ssuubb will pro‐
       ceed without a leap-second table.  For reliability, all programs should
       call lleeaappsseeccss__iinniitt at startup and check for errors.

       WWAARRNNIINNGG::  New  entries are added to the leap-second table on disk every
       12 to 18 months.  lleeaappsseeccss__rreeaadd may be called  repeatedly.   It  leaves
       the  old  table alone on error.  For reliability, all long-running pro‐
       grams should call lleeaappsseeccss__rreeaadd at least once every month.

SSEEEE AALLSSOO
       tai(3)



                                                                   leapsecs(3)
